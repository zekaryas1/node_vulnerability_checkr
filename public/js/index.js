function acceptFile() {
    var input = document.createElement("input");
    input.type = "file";

    input.onchange = (e) => {
        // getting a hold of the file reference
        var file = e.target.files[0];

        // setting up the reader
        var reader = new FileReader();
        reader.readAsText(file, "UTF-8");

        // here we tell the reader what to do when it's done reading...
        reader.onload = (readerEvent) => {
            var content = readerEvent.target.result; // this is the content!
            let jsonVersion = JSON.parse(content);

            if (jsonVersion.dependencies) {
                console.log(toSimpleArray(jsonVersion.dependencies));
                let dep = toSimpleArray(jsonVersion.dependencies);
                postMessageToServer(dep);
            }
            // if (jsonVersion.devDependencies) {
            //     console.log(toSimpleArray(jsonVersion.devDependencies));
            // }
        };
    };

    input.click();
}

/*
accept json object and returns a list
accept = {"a": 34,"b":45}
returns = ["pkg:npm/a@34", "pkg:npm/b@45"]
*/
function toSimpleArray(jsonObject) {
    let toReturn = [];
    for (obj in jsonObject) {
        var correct_version = jsonObject[obj].slice(1);
        toReturn.push(`pkg:npm/${obj}@${correct_version}`);
    }
    return toReturn;
}

function postMessageToServer(listOfDep) {
    fetch("/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            //   authorization:
            //     "Basic emVrYXJ5YXNkaW5rdUBnbWFpbC5jb206UTQuZ3VWRiMzN0BQQE1r",
        },
        body: {
            coordinates: listOfDep,
        },
    }).then();
}

