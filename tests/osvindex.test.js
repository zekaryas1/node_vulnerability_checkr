/* format */
const {format} = require("../bin/osvindex");
test('osv format works', () => {
    const listOfDependencies = {
        "jest": "^29.3.1",
        "nodemon": "^2.0.12"
    };
    expect(format(listOfDependencies)).toEqual([
        {
            "package": {
                "ecosystem": "npm",
                "name": 'jest'
            },
            "version": '29.3.1'
        },
        {
            "package": {
                "ecosystem": "npm",
                "name": 'nodemon'
            },
            "version": '2.0.12'
        },
    ]);
})

test('osv format works with ^,~,@ symbols', () => {
    const listOfDependencies = {
        "@jest": "^29.3.1",
        "nodemon": "~2.0.12"
    };
    expect(format(listOfDependencies)).toEqual([
        {
            "package": {
                "ecosystem": "npm",
                "name": 'jest'
            },
            "version": '29.3.1'
        },
        {
            "package": {
                "ecosystem": "npm",
                "name": 'nodemon'
            },
            "version": '2.0.12'
        },
    ]);
})